<!DOCTYPE html> 
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Blockchain</title>
    <!--

    Template 2108 Dashboard

	http://www.tooplate.com/view/2108-dashboard

    -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600">
    <!-- https://fonts.google.com/specimen/Open+Sans -->
    <link rel="stylesheet" href="css/fontawesome.min.css">
    <!-- https://fontawesome.com/ -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!-- https://getbootstrap.com/ -->
    <link rel="stylesheet" href="css/tooplate.css">

    <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script type="text/javascript">

    // shows list of fundraising events that the charity is hosting
    // create fundEvents table
    $(document).ready(() => {
        $('#events-table').DataTable( {
          "ajax": {
            // extracts data from url below which links to the FundEvent assets
            // need to change proxy
            url: "/hlf3/api/org.hyperledger_composer.project.FundEvent",
            dataSrc: ""
          },
          // data table's columns
          columns: [
            // column title is the Title to be shown in the table in the UI
            // data is the name of the data that you are extracting from the FundEvent asset. must state the exact name
            { title:"Event ID", data: "eventId" },
            { title:"Target Amount (SGD)", data: "targetAmount" },
            { title:"Amount Collected (SGD)", data: "amountCollected" },
            { title:"Amount Transferred (SGD)", data: "amountTransferred" },
            { title:"Deadline (MM/DD/YYYY)", data: "deadline" },
            { title:"Event Status", data: "status" },
            { title:"", render: function(data, type, row, meta){

            // creates a hyperlink for each row that links to the page to update details such as target amount and deadline for each event ID
            // by integrating event id, target amount, deadline and status in the url, we would be able to reflect the these in the form on the next page as well allowing for updating of event's details for the correct event id

            let htmlOutput = "<a href=\"charity-update-fund-event-listings.html?eventId=" + row.eventId + "&targetAmount=" + row.targetAmount + "&deadline=" + row.deadline + "&status=" + row.status +"\">Update</a>";
          $('#container').html(htmlOutput);
          return htmlOutput;   }
        },
            { title:"", render: function(data, type, row, meta){

            // creates a hyperlink for each row that links to the page to transfer the collected donations to the beneficiaries for each event ID

            let htmlOutput = "<a href=\"charity-confirm-transfer-funds.html?eventId=" + row.eventId +"\">Transfer</a>";
          $('#container').html(htmlOutput);
          return htmlOutput;   }
        },
          ]
        });
    });

    </script>
</head>

<body id="reportsPage" class="bg02">
    <div class="" id="home">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <nav class="navbar navbar-expand-xl navbar-light bg-light">
                        <a class="navbar-brand">
                            <h1 class="tm-site-title mb-0">Charity</h1>
                        </a>
                        <button class="navbar-toggler ml-auto mr-0" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                            aria-expanded="false" aria-label="Toggle navigation">
                            <span class="navbar-toggler-icon"></span>
                        </button>

                        <div class="collapse navbar-collapse" id="navbarSupportedContent">
                            <ul class="navbar-nav mx-auto">

                                <li class="nav-item active">
                                    <a class="nav-link" href="charity-fund-event-listings.html">Fund Event Listings</a>
                                </li>

                                <li class="nav-item">
                                <a class="nav-link" href="charity-fund-event-requests.html">Fund Event Requests</a>
                            </li>

                                <li class="nav-item">
                                    <a class="nav-link" href="charity-pending-donations.html">Pending Donations</a>
                                </li>

                                <li class="nav-item">
                                    <a class="nav-link" href="charity-transfer-funds.html">Transfers</a>
                                </li>

                                <li class="nav-item">
                                    <a class="nav-link" href="charity-profile.html">My Profile</a>
                                </li>

                            </ul>
                            <ul class="navbar-nav">
                                <li class="nav-item">
                                    <a class="nav-link d-flex" href="login.html">
                                        <i class="far fa-user mr-2 tm-logout-icon"></i>
                                        <span>Logout</span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </nav>
                </div>
            </div>
            <!-- row -->
            <div class="row tm-content-row tm-mt-big">
                <div class="col-xl-12 col-lg-12 tm-md-12 tm-sm-12 tm-col">
                    <div class="bg-white tm-block h-100">
                        <div class="row">
                            <div class="col-md-8 col-sm-12">
                                <h2 class="tm-block-title d-inline-block">Fund Event Listings</h2>
                                
                            </div>
                        </div>
                        <!--Links to the datatable-->
                        <div class="table-responsive">
                            <table class="table table-striped tm-table-striped-even mt-3" id="events-table">
                                
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="js/jquery-3.3.1.min.js"></script>
    <!-- https://jquery.com/download/ -->
    <script src="js/bootstrap.min.js"></script>
    </script>
    </script>
    <!--datatables-->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css">
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js">
    </script>
    <!--bootstrap-->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.3/js/bootstrap-select.js"></script>
    <script>
        $(function () {
            $('.tm-product-name').on('click', function () {
                window.location.href = "charity-update-fund-event-listings.html";
            });
        })
    </script>
</body>

</html>